"use strict";(globalThis.webpackChunk_github_ui_github_ui=globalThis.webpackChunk_github_ui_github_ui||[]).push([["packages_notifications-subscriptions-menu_entry_ts-packages_promise-with-resolvers-polyfill_p-df0233"],{49936:(e,t,s)=>{s.d(t,{I:()=>a});let a=(0,s(96540).createContext)(null)},87057:(e,t,s)=>{s.d(t,{O:()=>r,S:()=>i});var a=s(71315);let n=a.cg?.document?.head?.querySelector('meta[name="release"]')?.content||"",i="X-GitHub-Client-Version";function r(){return n}},51987:(e,t,s)=>{s.d(t,{jC:()=>o,kt:()=>r,tV:()=>l});var a=s(87057),n=s(69599),i=s(13523);function r(e){let t={"X-Requested-With":"XMLHttpRequest",...(0,i.wE)(e)};return(0,n.G7)("client_version_header")&&(t={...t,[a.S]:(0,a.O)()}),t}function l(e,t){for(let[s,a]of Object.entries(r(t)))e.set(s,a)}function o(e){return{"X-GitHub-App-Type":e}}},13523:(e,t,s)=>{s.d(t,{$r:()=>r,M1:()=>l,li:()=>n,pS:()=>c,wE:()=>o});var a=s(71315);let n="X-Fetch-Nonce",i=new Set;function r(e){i.add(e)}function l(){return i.values().next().value||""}function o(e){let t={};return void 0!==e&&(t["X-Fetch-Nonce-To-Validate"]=e),void 0===e?t[n]=l():i.has(e)?t[n]=e:t[n]=Array.from(i).join(","),t}function c(){let e=a.XC?.head?.querySelector('meta[name="fetch-nonce"]')?.content||"";e&&r(e)}},73189:(e,t,s)=>{s.d(t,{l:()=>a});let a=()=>void 0},24117:(e,t,s)=>{var a=s(7123),n=s(74848),i=s(96540),r=s(27042),l=s(99906),o=s(15220),c=s(38621),d=s(96379);let u=async e=>{try{let t=await (0,d.DI)("/notifications/subscribe",{method:"POST",body:e});if(t.ok)return t;return Error("Failed to update")}catch(e){return e}};var h=s(5524);let p={NONE:"none",WATCHING:"watching",IGNORING:"ignoring",CUSTOM:"custom"},m={[p.NONE]:"Participating and @mentions",[p.WATCHING]:"All Activity",[p.IGNORING]:"Ignore",[p.CUSTOM]:"Custom"},b={...m,[p.NONE]:"Participating"},y={[p.NONE]:"Watch",[p.WATCHING]:"Unwatch",[p.IGNORING]:"Stop ignoring",[p.CUSTOM]:"Unwatch"},f=[{name:m[p.NONE],description:"Only receive notifications from this repository when participating or @mentioned.",subscriptionType:p.NONE},{name:m[p.WATCHING],description:"Notified of all notifications on this repository.",subscriptionType:p.WATCHING},{name:m[p.IGNORING],description:"Never be notified.",subscriptionType:p.IGNORING},{name:m[p.CUSTOM],description:"Select events you want to be notified of in addition to participating and @mentions.",trailingIcon:(0,i.createElement)(c.ArrowRightIcon),subscriptionType:p.CUSTOM}],N=e=>e in y?y[e]:"",g={subscriptionTypeName:"SubscriptionList-module__subscriptionTypeName--feJ4k"};function C(e){return(0,n.jsx)(h.l,{selectionVariant:"single",children:f.map((t,s)=>(0,n.jsxs)(i.Fragment,{children:[(0,n.jsxs)(h.l.Item,{selected:t.subscriptionType===e.selected,onSelect:()=>e.onSelect(t.subscriptionType),children:[(0,n.jsx)("span",{className:g.subscriptionTypeName,children:t.name}),(0,n.jsx)(h.l.Description,{variant:"block",children:t.description}),t.trailingIcon?(0,n.jsx)(h.l.TrailingVisual,{children:t.trailingIcon}):null]}),s!==f.length-1?(0,n.jsx)(h.l.Divider,{}):""]},s))})}try{C.displayName||(C.displayName="SubscriptionList")}catch{}var x=s(36284),T=s(88432),v=s(5839),S=s(21373);function j(e){let[t,s]=(0,i.useState)(!1),[a,r]=(0,i.useState)(""),l=e.items.filter(e=>e?.text?.toLowerCase().startsWith(a.toLowerCase()));return(0,n.jsx)(v.X,{title:"Select labels",renderAnchor:({children:t,...s})=>0===e.items.length?(0,n.jsx)(S.Q,{...s,trailingAction:c.TriangleDownIcon,"aria-haspopup":"dialog",children:"No labels available"}):(0,n.jsxs)(S.Q,{...s,trailingAction:c.TriangleDownIcon,"aria-haspopup":"dialog",children:[(0,n.jsx)("span",{className:"color-fg-muted",children:"Labels: "}),(0,n.jsx)("span",{id:"select-labels",children:e.labelsText})]}),placeholder:"Filter labels",open:t,onCancel:e.resetLabels,onOpenChange:(t,a)=>{s(t),"click-outside"===a&&e.applyLabels()},items:l,selected:e.selectedLabels,onSelectedChange:e.onChangeLabels,onFilterChange:r,showItemDividers:!0,overlayProps:{width:"small",height:"medium",maxHeight:"medium"}})}try{j.displayName||(j.displayName="FilterLabels")}catch{}var w=s(69726);let I={footerContainer:"FooterActions-module__footerContainer--sNVyn",buttonsContainer:"FooterActions-module__buttonsContainer--XOX1_",errorMessageText:"FooterActions-module__errorMessageText--LtM5d",FooterActionsSpinner:"FooterActions-module__FooterActionsSpinner--WjF07",applyButton:"FooterActions-module__applyButton--Q5SC4"};function _(e){let[t,s]=(0,i.useState)(!1),a=(0,i.useCallback)(()=>(e.nextFocusRef?.current?.focus(),!0),[e.nextFocusRef]),r=(0,i.useCallback)(()=>{s(!0)},[]),l=(0,i.useCallback)(()=>{e.onApply(),setTimeout(()=>{e?.checkStatus&&e.checkStatus(r)},600)},[e,r]);return(0,n.jsxs)("div",{className:I.footerContainer,children:[e.showError?(0,n.jsx)("span",{className:I.errorMessageText,children:"Error. Please try again."}):null,(0,n.jsxs)("div",{className:I.buttonsContainer,style:e.overrideButtonStyles??{padding:"var(--base-size-16)"},children:[!e.showError&&t?(0,n.jsx)(w.A,{size:"small",className:I.FooterActionsSpinner}):null,(0,n.jsx)(S.Q,{size:"small",onClick:()=>e.onCancel(),onBlur:t=>{e.disabled&&a(t)},children:"Cancel"}),(0,n.jsx)(S.Q,{disabled:e.disabled,variant:"primary",size:"small",onClick:()=>l(),onBlur:a,className:I.applyButton,children:"Apply"})]})]})}try{_.displayName||(_.displayName="FooterActions")}catch{}let A=e=>{let t=L(e,2);if(e.length>=2){if(2===e.length)return k(e);let s=L(e,3);if(s.length>30)return`${t.slice(0,30)}... +${e.length-2} more`;{let t=e.length>3?` +${e.length-3} more`:"";return`${s}${t}`}}if(1!==e.length)return"All";{let t=e[0]?.text||"";return t.length>30?`${t.slice(0,30)}...`:t}},k=e=>{let t=e[0]?.text||"",s=L(e,2);return s.length>30?t.length>25?`${t.slice(0,25)}... +1 more`:`${s.slice(0,30)}...`:s},L=(e,t)=>e.slice(0,t).map(e=>e.text).join(", "),R=e=>{switch(e){case"PullRequest":return"Pull requests";case"SecurityAlert":return"Security alerts";default:return`${e}s`}},O={filterContainer:"ThreadList-module__filterContainer--R6lFt",threadContent:"ThreadList-module__threadContent--x7fVL",threadRow:"ThreadList-module__threadRow--LKENb",threadDisabledMessage:"ThreadList-module__threadDisabledMessage--kfUK2"};function M(e){let[t,s]=(0,i.useState)(e.appliedThreads),[a,r]=(0,i.useState)(e.appliedLabels),[l,o]=(0,i.useState)(e.appliedLabels),[c,d]=(0,i.useState)(()=>A(e.appliedLabels));(0,i.useEffect)(()=>{e.appliedLabels.length>0&&!t.includes("Issue")&&s([...t,"Issue"])},[]);let u=(0,i.useCallback)(e=>{t&&t.includes(e)?s(t.filter(t=>t!==e)):s([...t,e])},[t]),h=(0,i.useCallback)(()=>{e.applyThreads(t)},[e,t]),p=(0,i.useCallback)(e=>{o(e),d(A(e))},[]),m=(0,i.useCallback)(()=>{r(l)},[l]),b=(0,i.useCallback)(()=>{o(a),d(A(a))},[a]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:O.threadContent,children:e.subscribableThreadTypes.map((s,a)=>(0,n.jsxs)("div",{className:O.threadRow,style:a===e.subscribableThreadTypes.length-1?{}:{borderBottom:"1px solid var(--borderColor-default, var(--color-border-default))"},children:[(0,n.jsxs)(x.A,{children:[(0,n.jsx)(T.A,{checked:t.includes(s.name),onChange:()=>u(s.name)}),(0,n.jsx)(x.A.Label,{children:R(s.name)})]}),s.enabled?null:(0,n.jsxs)("p",{className:O.threadDisabledMessage,children:[R(s.name)," are not enabled for this repository"]}),(0,n.jsx)("div",{"aria-live":"polite",children:"Issue"===s.name&&e.showLabelSubscriptions&&t.includes("Issue")?(0,n.jsx)("div",{className:O.filterContainer,children:(0,n.jsx)(j,{filterAction:h,items:e.repoLabels,labelsText:c,onChangeLabels:p,selectedLabels:l,applyLabels:m,resetLabels:b})}):null})]},a))}),(0,n.jsx)(_,{onCancel:e.cancelMenuCallback,onApply:()=>e.saveThreads(t,l),showError:e.showError,disabled:0===t.length||e.isSavingThreads})]})}try{M.displayName||(M.displayName="ThreadList")}catch{}let E={watchCounter:"NotificationsSubscriptionsMenu-module__watchCounter--vgIup",watchButton:"NotificationsSubscriptionsMenu-module__watchButton--ccU5u",subscriptionDialog:"NotificationsSubscriptionsMenu-module__subscriptionDialog--H1n3k",ActionMenuButton:"NotificationsSubscriptionsMenu-module__ActionMenuButton--UgYy6"};function G({repositoryId:e,repositoryName:t,watchersCount:s,subscriptionType:a,subscribableThreadTypes:d,repositoryLabels:h,showLabelSubscriptions:m}){let y=(0,i.useMemo)(()=>h.map(e=>({id:e.id,text:e.name,selected:e.subscribed})),[h]),f=y.filter(e=>e.selected),g=(0,i.useMemo)(()=>d.map(e=>e.subscribed||"Issue"===e.name&&m&&f.length>0?e.name:null).filter(e=>null!==e),[d,m,f]),[x,T]=(0,i.useState)(!1),[v,S]=(0,i.useState)(!1),[j,w]=(0,i.useState)(!1),I=(0,i.useCallback)(()=>w(!1),[]),[_,A]=(0,i.useState)(g.length>0?p.CUSTOM:a),[k,L]=(0,i.useState)(_),[R,O]=(0,i.useState)(g),[G,F]=(0,i.useState)(f),[P,$]=(0,i.useState)(!1),B=(0,i.useRef)(null),U=(0,i.useCallback)(()=>{S(!1),A(k)},[k]),D=(0,i.useCallback)(async(t,s)=>{$(!0),O(t),F(s),L(p.CUSTOM);let a=new FormData;a.set("do","custom"),a.set("repository_id",e),t.map(e=>{a.append("thread_types[]",e)}),s.map(e=>{e.id&&a.append("labels[]",e.id.toString())}),(await u(a)).ok?(S(!1),$(!1)):T(!0)},[e]),H=(0,i.useCallback)(async t=>{let s=new FormData;return t===p.IGNORING?s.set("do","ignore"):t===p.WATCHING?s.set("do","subscribed"):(t===p.NONE||t===p.CUSTOM&&0===R.length)&&s.set("do","included"),s.append("thread_types[]",""),s.set("repository_id",e),!(await u(s) instanceof Error)},[e,R]),W=(0,i.useCallback)(async e=>{e===p.CUSTOM?(S(!0),A(p.CUSTOM)):await H(e)?(A(e),L(e),O([])):w(!0)},[A]),X=(0,i.useCallback)(e=>{O(e)},[O]),V=(0,i.useMemo)(()=>((e,t)=>{let s=N(e),a=b[e];return e===p.IGNORING?`${s} in ${t}`:`${s}: ${a} in ${t}`})(_,t),[_,t]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"d-md-none",children:(0,n.jsxs)(r.W,{children:[(0,n.jsx)(r.W.Button,{"data-testid":"notifications-subscriptions-menu-button-desktop",leadingVisual:_===p.IGNORING?c.BellSlashIcon:c.EyeIcon,trailingAction:null,className:E.watchButton,"aria-label":V,children:(0,n.jsx)(n.Fragment,{})}),(0,n.jsx)(r.W.Overlay,{width:"medium",children:(0,n.jsx)(C,{selected:_,onSelect:W})})]})}),(0,n.jsx)("div",{className:"d-none d-md-block",children:(0,n.jsxs)(r.W,{children:[(0,n.jsxs)(r.W.Button,{"data-testid":"notifications-subscriptions-menu-button-mobile",size:"small",leadingVisual:_===p.IGNORING?c.BellSlashIcon:c.EyeIcon,className:E.ActionMenuButton,"aria-label":V,children:[N(_),(0,n.jsx)("span",{className:`ml-2 Counter rounded-3 ${E.watchCounter}`,children:s})]}),(0,n.jsx)(r.W.Overlay,{width:"medium",children:(0,n.jsx)(C,{selected:_,onSelect:W})})]})}),(0,n.jsx)(l.A,{className:E.subscriptionDialog,returnFocusRef:B,isOpen:v,onDismiss:()=>U(),"aria-labelledby":"header",children:(0,n.jsxs)("div",{"data-testid":"inner",children:[(0,n.jsxs)(l.A.Header,{id:"header",children:["Subscribe to events for ",t]}),(0,n.jsx)(M,{subscribableThreadTypes:d,showLabelSubscriptions:m,cancelMenuCallback:U,appliedThreads:R,repoLabels:y,subscribedThreads:g,applyThreads:X,appliedLabels:G,saveThreads:D,showError:x,isSavingThreads:P})]})}),j&&(0,n.jsx)(o.l,{title:"Cannot watch this repository",onClose:I,children:(0,n.jsxs)(o.l.Body,{children:["You have reached the limit of 10,000 watched repositories. Update your"," ",(0,n.jsx)("a",{href:"/watching",children:"watch settings"})," to continue."]})})]})}try{G.displayName||(G.displayName="NotificationsSubscriptionsMenu")}catch{}(0,a.k)("notifications-subscriptions-menu",{Component:G})},51407:(e,t,s)=>{s.d(t,{Y:()=>a});function a(){let e={};return e.promise=new Promise((t,s)=>{e.resolve=t,e.reject=s}),e}},28600:(e,t,s)=>{s.d(t,{A:()=>l});let{getItem:a,setItem:n,removeItem:i}=(0,s(82075).A)("localStorage"),r="REACT_PROFILING_ENABLED",l={enable:()=>n(r,"true"),disable:()=>i(r),isEnabled:()=>!!a(r)}},70263:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(88431),n=s(96540);function i(){let e=(0,n.useRef)(!1),t=(0,n.useCallback)(()=>e.current,[]);return(0,a.N)(()=>(e.current=!0,()=>{e.current=!1}),[]),t}},88431:(e,t,s)=>{s.d(t,{N:()=>i});var a=s(71315),n=s(96540);let i=void 0!==a.cg?.document?.createElement?n.useLayoutEffect:n.useEffect},42255:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(70263),n=s(96540);let i=function(e){let t=(0,a.A)(),[s,i]=(0,n.useState)(e);return[s,(0,n.useCallback)(e=>{t()&&i(e)},[t])]}},96379:(e,t,s)=>{s.d(t,{DI:()=>i,QJ:()=>l,Sr:()=>o,lS:()=>r});var a=s(51987),n=s(88057);async function i(e,t={}){var s=e;if(new URL(s,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch");let r=function(e){let t=new URL(e,window.location.href),s=new URL(window.location.href,window.location.origin),a=s.searchParams.get("_features");a&&!t.searchParams.has("_features")&&t.searchParams.set("_features",a);let n=s.searchParams.get("_tracing");return n&&!t.searchParams.has("_tracing")&&t.searchParams.set("_tracing",n),e.startsWith(window.location.origin)?t.href:`${t.pathname}${t.search}`}(e),l={...t.headers,"GitHub-Verified-Fetch":"true",...(0,a.kt)()},o=await fetch(r,{...t,headers:l}),c=o?.headers?.get("X-Github-Request-Id");return c&&(0,n.Ex)(c),o}function r(e,t){let s={...t?.headers??{},Accept:"application/json","Content-Type":"application/json"},a=t?.body?JSON.stringify(t.body):void 0;return i(e,{...t,body:a,headers:s})}function l(e,t={}){let s={...t.headers,"GitHub-Is-React":"true"};return i(e,{...t,headers:s})}function o(e,t){let s={...t?.headers??{},"GitHub-Is-React":"true"};return r(e,{...t,headers:s})}},57224:(e,t,s)=>{s.d(t,{y:()=>r});var a=s(74848),n=s(21728),i=s(49936);function r(e){let t,s,r=(0,n.c)(7),{children:l,appName:o,category:c,metadata:d}=e;r[0]!==o||r[1]!==c||r[2]!==d?(t={appName:o,category:c,metadata:d},r[0]=o,r[1]=c,r[2]=d,r[3]=t):t=r[3];let u=t;return r[4]!==l||r[5]!==u?(s=(0,a.jsx)(i.I.Provider,{value:u,children:l}),r[4]=l,r[5]=u,r[6]=s):s=r[6],s}try{r.displayName||(r.displayName="AnalyticsProvider")}catch{}},76629:(e,t,s)=>{s.d(t,{BP:()=>u,D3:()=>d,O8:()=>o});var a=s(74848),n=s(21728),i=s(96540),r=s(71315),l=s(88431);let o={ServerRender:"ServerRender",ClientHydrate:"ClientHydrate",ClientRender:"ClientRender"},c=(0,i.createContext)(o.ClientRender);function d(e){let t,s,d,u,h=(0,n.c)(8),{wasServerRendered:p,children:m}=e;h[0]!==p?(t=()=>r.X3?o.ServerRender:p?o.ClientHydrate:o.ClientRender,h[0]=p,h[1]=t):t=h[1];let[b,y]=(0,i.useState)(t);return h[2]!==b?(s=()=>{b!==o.ClientRender&&y(o.ClientRender)},d=[b],h[2]=b,h[3]=s,h[4]=d):(s=h[3],d=h[4]),(0,l.N)(s,d),h[5]!==m||h[6]!==b?(u=(0,a.jsx)(c.Provider,{value:b,children:m}),h[5]=m,h[6]=b,h[7]=u):u=h[7],u}function u(){return(0,i.useContext)(c)}try{c.displayName||(c.displayName="RenderPhaseContext")}catch{}try{d.displayName||(d.displayName="RenderPhaseProvider")}catch{}},43258:(e,t,s)=>{s.d(t,{Qn:()=>o,T8:()=>d,Y6:()=>h,k6:()=>u});var a=s(74848),n=s(52870),i=s(96540),r=s(73189),l=s(42255);let o=5e3,c=(0,i.createContext)({addToast:r.l,addPersistedToast:r.l,clearPersistedToast:r.l}),d=(0,i.createContext)({toasts:[],persistedToast:null});function u({children:e}){let[t,s]=(0,l.A)([]),[r,u]=(0,i.useState)(null),{safeSetTimeout:h}=(0,n.A)(),p=(0,i.useCallback)(function(e){s([...t,e]),h(()=>s(t.slice(1)),o)},[t,h,s]),m=(0,i.useCallback)(function(e){u(e)},[u]),b=(0,i.useCallback)(function(){u(null)},[u]),y=(0,i.useMemo)(()=>({addToast:p,addPersistedToast:m,clearPersistedToast:b}),[m,p,b]),f=(0,i.useMemo)(()=>({toasts:t,persistedToast:r}),[t,r]);return(0,a.jsx)(c.Provider,{value:y,children:(0,a.jsx)(d.Provider,{value:f,children:e})})}function h(){return(0,i.useContext)(c)}try{c.displayName||(c.displayName="ToastContext")}catch{}try{d.displayName||(d.displayName="InternalToastsContext")}catch{}try{u.displayName||(u.displayName="ToastContextProvider")}catch{}},40064:(e,t,s)=>{s.d(t,{V:()=>h});var a=s(74848),n=s(96540),i=s(43258),r=s(38621),l=s(52870),o=s(56149);let c={info:"",success:"Toast--success",error:"Toast--error"},d={info:(0,a.jsx)(r.InfoIcon,{}),success:(0,a.jsx)(r.CheckIcon,{}),error:(0,a.jsx)(r.StopIcon,{})},u=({message:e,timeToLive:t,icon:s,type:i="info",role:r="log"})=>{let[u,h]=n.useState(!0),{safeSetTimeout:p}=(0,l.A)();return(0,n.useEffect)(()=>{t&&p(()=>h(!1),t-300)},[p,t]),(0,a.jsx)(o.ZL,{children:(0,a.jsx)("div",{className:"p-1 position-fixed bottom-0 left-0 mb-3 ml-3",children:(0,a.jsxs)("div",{className:`Toast ${c[i]} ${u?"Toast--animateIn":"Toast--animateOut"}`,id:"ui-app-toast","data-testid":`ui-app-toast-${i}`,role:r,children:[(0,a.jsx)("span",{className:"Toast-icon",children:s||d[i]}),(0,a.jsx)("span",{className:"Toast-content",children:e})]})})})};try{u.displayName||(u.displayName="Toast")}catch{}function h(){let{toasts:e,persistedToast:t}=(0,n.useContext)(i.T8);return(0,a.jsxs)(a.Fragment,{children:[e.map((e,t)=>(0,a.jsx)(u,{message:e.message,icon:e.icon,timeToLive:i.Qn,type:e.type,role:e.role},t)),t&&(0,a.jsx)(u,{message:t.message,icon:t.icon,type:t.type,role:t.role})]})}try{h.displayName||(h.displayName="Toasts")}catch{}}}]);
//# sourceMappingURL=packages_notifications-subscriptions-menu_entry_ts-packages_promise-with-resolvers-polyfill_p-df0233-cd05b475b6c0.js.map